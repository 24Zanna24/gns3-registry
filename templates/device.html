{% extends "layout/default.html" %}

{% block script %}

function download(device, md5sum) {
    if (gns3_button(function() {
        return gns3.download(device, md5sum)
    })) {
        gns3_notif("success", "You can see the download progress in the <a href=\"/downloads.html\">Downloads</a> section");
        return true;
    }
    return false;
}

{% endblock %}

{% block body %}
    <div class="jumbotron">
        <h1>{{ device["name"] }}</h1>
        Category {{ device["category"]Â }}<br />
        Product: <a href="{{ device["product_url"] }}">{{ device["product_name"] }}</a><br />
        Vendor: <a href="{{ device["vendor_url"] }}">{{ device["vendor_name"] }}</a><br />
        Documentation: <a href="{{ device["documentation_url"] }}">{{ device["documentation_url"] }}</a><br />
        Status: {{ device["status"] }}<br />
        Maintainer: <a href="mailto:{{ device["maintainer_email"] }}">{{ device["maintainer"] }}</a>
    </div>
    {% if "qemu" in device %}
        <h2>Qemu settings</h2>
        {% for key in device["qemu"] %}
            {{ key }}: {{ device["qemu"][key] }}<br />
        {% endfor %}
    {% endif %}
    {% for version in device["versions"] | reverse %}
        <h2>{{ device["name"] }} {{version["name"]}}</h2>
        <button class="btn btn-primary btn-lg" type="button" onclick='gns3_button(function() { return gns3.install("{{device|jsonify|b64encode}}", "{{version["name"]}}") })'>Install</button>
        <h3>Require files</h3>
        {% for image in version.images.values() %}
            <h4>{{image["filename"]}}</h4>
            Slot: {{image["type"]}}<br />
            File Version: {{image["version"]}}<br />
            Checksum: {{image["md5sum"]}}<br />
            Download url: <a href="{{image["download_url"]}}">{{image["download_url"]}}</a><br />
            {% if "direct_download_url" in image %}
            Direct download url: <a href="{{image["direct_download_url"]}}">{{image["direct_download_url"]}}</a><br />
            <button class="btn btn-primary btn-lg" type="button" onclick='return download("{{device|jsonify|b64encode}}", "{{image["md5sum"]}}")'>Download</button>
            {% endif %}
            <hr />
        {% endfor %}
    {% endfor %}
{% endblock %}
